<div ng-controller="MainTradeController" ng-init="initTrades()">
  <div class="row-fluid">
    <div class="span3">
      <%= form_tag search_trades_path, :method => :get do %>
      <div class="control-group">
        <div class="input-append">
          <%= text_field_tag :search, params[:search], :class => 'span2', :id => 'appendedInputButton-03', :placeholder => 'Search Trades' %>
          <div class="btn-group">
            <%= button_tag '', :name => nil, :class => 'btn' do %>
            <%= content_tag :span, :class => 'fui-search' do %>
            <% end %>
            <% end %>
          </div>
        </div>
      </div>
      <% end %>
    </div>
    <div class="offset7 span2">
      <%= link_to 'New Trade', new_trade_path, :class => 'btn btn-block btn-primary' %>
    </div>

  </div>

  <div class="row-fluid">
    <div class="span3">
      <div class="well">
        <p>Hot Courses</p>
        3800250 Human Relations <br /> 3503111 Intro to Classic Music
      </div>
    </div>

    <div class="span9">

      <div class="row-fluid mbl">
        <div class="span12">
          <h3>Recent Trades</h3>
        </div>
      </div>

      <div ng-repeat="trade in trades">

      <div class="row-fluid">
        <div class="span12">
          <div class="well">
            <div class="row-fluid mbm">
              <div class="span10">
                <div class="media">
                  <a class="pull-left" href="#"> <img class="media-object"
                    src="custom/images/profile-1-pic-64.jpg">
                  </a>
                  <div class="media-body">
                    <h4 class="media-heading">
                      <a href="{{trade.user.url}}">{{trade.user.name}}</a> wants to trade
                    </h4>
                    {{formatDate(trade.created_at)}}
                  </div>
                </div>
              </div>
              <div class="span2">
                <div style="text-align: right">Trade #{{trade.id}}</div>
                <a href="{{trade.url}}" class="btn btn-small btn-primary pull-right">Go to trade</a>
              </div>
            </div>
            <div class="row-fluid">
              <div class="span6">
                <div class="popover topic-box">
                  <h3 class="popover-title topic-box-title">Have</h3>
                  <div class="popover-content">
                    <div ng-repeat="have_course in trade.have_courses">
                    <p>{{have_course.course_number}} {{have_course.course_name}} ({{have_course.course_section}})</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="span6">
                <div class="popover topic-box">
                  <h3 class="popover-title topic-box-title">Want</h3>
                  <div class="popover-content">
                    <div ng-repeat="want_course in trade.want_courses">
                    <p>{{want_course.course_number}} {{want_course.course_name}} ({{want_course.course_section}})</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      </div>

      <div class="row-fluid">
        <div class="span12">
          <button class="btn btn-block btn-primary" ng-show="more" ng-click="loadMoreTrades()">More</button>
        </div>
      </div>

    </div>
  </div>
</div>
